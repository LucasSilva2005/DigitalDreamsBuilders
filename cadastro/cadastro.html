<!DOCTYPE html>
<html lang="pt-BR">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link rel="stylesheet" href="cadastro.css" />
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.6.0/css/all.min.css"
    />
    <title>Cadastro - Digital Dreams Builders</title>
  </head>

  <body>
    <div class="login-container">
      <h1>Cadastro</h1>
      <form id="signup-form">
        <div class="form-group">
          <div class="icon">
            <i class="fa-solid fa-envelope"></i>
            <input type="text" id="email" name="email" placeholder="Email" required />
          </div>
        </div>

        <div class="form-group">
          <div class="icon">
            <i class="fa-solid fa-lock"></i>
            <input
              type="password"
              id="password"
              name="password"
              placeholder="Senha"
              required
            />
          </div>
        </div>

        <!-- Requisitos da senha -->
        <div class="checklists_cadastro">
          <div id="minLength">
            A senha deve conter, no mínimo, 8 caracteres.
          </div>

          <div id="uppercase">
            A senha deve conter, no mínimo, uma letra maiúscula.
          </div>

          <div id="specialChar">
            A senha deve conter, no mínimo, um caractere especial (Ex.: @, #, -, _).
          </div>
        </div>

        <button class="button" type="submit">Cadastrar</button>

        <a class="login" href="/login/login.html">Voltar a página de login</a>
      </form>
    </div>

    <!-- Firebase App e Database SDKs -->
    <script type="module">
      import { initializeApp } from 'https://www.gstatic.com/firebasejs/9.18.0/firebase-app.js';
      import { getDatabase, ref, set } from 'https://www.gstatic.com/firebasejs/9.18.0/firebase-database.js';

      // Configuração do Firebase
      const firebaseConfig = {
        apiKey: 'AIzaSyBxVY9aeTO0LJP92zG4WGfsIY-U99w6sWI',
        authDomain: 'digital-dreams-builders.firebaseapp.com',
        databaseURL: 'https://digital-dreams-builders-default-rtdb.firebaseio.com',
        projectId: 'digital-dreams-builders',
        storageBucket: 'digital-dreams-builders.appspot.com',
        messagingSenderId: '116614795521',
        appId: '1:116614795521:web:5c1b2432f9c55cb93e4b00'
      };

      // Inicializa o Firebase
      const app = initializeApp(firebaseConfig);
      const database = getDatabase(app);

      // Função para salvar dados no banco de dados
      function salvarDados(userId, email, senha) {
        set(ref(database, 'users/' + userId), {
          email: email,
          senha: senha
        })
        .then(() => {
          console.log('Dados salvos com sucesso!');
        })
        .catch((error) => {
          console.error('Erro ao salvar dados: ', error);
        });
      }

      // Adiciona um ouvinte de evento ao formulário
      const signupForm = document.getElementById('signup-form');
      signupForm.addEventListener('submit', (event) => {
        event.preventDefault(); // Evita o envio automático do formulário

        // Obtém os dados do formulário
        const email = document.getElementById('email').value;
        const senha = document.getElementById('password').value;

        // Verifica se os campos estão preenchidos
        if (email && senha) {
          // Gerar um ID de usuário aleatório
          const userId = Math.random().toString(36).substring(2, 15);

          // Salva os dados no Firebase
          salvarDados(userId, email, senha);

          // Exibir uma mensagem de sucesso
          alert('Cadastro realizado com sucesso!');
        } else {
          alert('Por favor, preencha todos os campos.');
        }
      });
    </script>
  </body>
</html>
